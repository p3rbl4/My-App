# Стек протоколов TCP/IP - это набор правил обмена информацией.
В компьютерных сетях работающих по протоколам TCP/IP, аналогом бумажного письма является **пакет** 

***Как правило, взаимодействие осуществляется по принципу "клиент - сервер"***
Клиент запрашивает информацию, сервер принимает запрос, обрабатывает его и посылает результат обратно
Большинство программ на ПК являются клиентами:
- Почтовый клиент Outlook
- Браузеры Chrome, Explorer 
Номера портов на клиенте не фиксированные, как у сервера, а назначаются ОС динамически. 
Фиксированные серверные порты как правило имеют номер до 1024 (есть исключения), а клиентские начинаются после 1024

***Как работает модель TCP/IP (сетевая модель передачи данных, описывает способ передачи данных от источника информации к получателю)***

*На примере того, как работает любое обращение к сайту.*

На ***прикладном*** уровне необходимо сформировать серверу запрос (http,https,ftp,file)
Допустим мы хотим открыть сайт в браузере
Дальшем ***транспортный*** уровень. Здесь включаются протоколы (tcp и udp) в загаловке пакета добавляем порт, который нужен.
Дальше ***сетевой*** уровень, где мы получаем Ip_adress
Дальше ***канальный*** уровень, который при помощи протокола ARP определяет, есть ли Ip адрес в сети. 
Если в ответ тишина, то ARP отдаёт адрес на шлюз, тот поднимается на уровень выше и ищет там. 

***Как работает любое обращение к сайту?***
После того как мы ввели доменное имя сайта URL в адресную строку, ОС отправляет запрос на наш DNS-сервер, допустим на сокет 91.168.75.42:53, а DNS сервер обработав запрос, возвращает IP-адрес, который соответствует доменному имени.

***Список портов с которыми прийдётся сталкиваться***

**135-139** — эти порты используются Windows для доступа к общим ресурсам компьютера — папкам, принтерам. Не открывайте эти порты наружу, т.е. в районную локальную сеть и Интернет. Их следует закрыть фаерволлом. Также если в локальной сети вы не видите ничего в сетевом окружении или вас не видят, то вероятно это связано с тем, что фаерволл заблокировал эти порты. Таким образом для локальной сети эти порты должны быть открыты, а для Интернета закрыты.

**21** — порт **FTP** сервера.

**25** — порт почтового **SMTP** сервера. Через него ваш почтовый клиент отправляет письма. IP адрес SMTP сервера и его порт (25-й) следует указать в настройках вашего почтового клиента.

**110** — порт **POP3** сервера. Через него ваш почтовый клиент забирает письма из вашего почтового ящика. IP адрес POP3 сервера и его порт (110-й) также следует указать в настройках вашего почтового клиента.

**80** — порт **WEB**-сервера.

**3128, 8080** — прокси-серверы (настраиваются в параметрах браузера).

# Что такое маска подсети и шлюз по умолчанию (роутер, маршрутизатор)?

Компьютеры объединяются в локальные сети. В локальной сети компьютеры напрямую «видят» только друг друга. Локальные сети соединяются друг с другом через шлюзы (роутеры, маршрутизаторы). Маска подсети предназначена для определения — принадлежит ли компьютер-получатель к этой же локальной сети или нет. Если компьютер-получатель принадлежит этой же сети, что и компьютер-отправитель, то пакет передается ему напрямую, в противном случае пакет отправляется на шлюз по умолчанию, который далее, по известным ему маршрутам, передает пакет в другую  сеть.

# Уровни и их протоколы
Представление уровней и протоколов стека TCP/IP в изображениях
![[Pasted image 20230324230527.png]]
![[Pasted image 20230324230643.png]]

***Канальный, физический или просто сетевой интерфейс***
Данный уровень описывает как и что каналы, такие как последовательные линии и классический Ethernet, должны сделать, чтобы удовлетворить потребностям межсетевого уровня. *Здесь задача состоит в кодировании информации, её делению на пакеты и отправке по нужному каналу.*

# Нет различия между физическим уровнем и передачи данных (канальным)

В данной модели нет разлияи между физическим уровнеи и уровнем передачи данных, хоть они и абсолютно разные. **Физически уровень** должен иметь дело с характеристиками передачи информации по медному кабелю, оптическому волокну и по радио, тогда как задачей **уровня передачи данных** является определение начала и конца кадров и передача их с одной стороны на другую с требуемой степенью надежности. Правильная модель должна содержать их как два различных уровня. В модели TCP/IP этого нет

***Межсетевой уровень***
**Межсетевой уровень является основой всей архитектуры**. Его задача заключается в обеспечении возможности каждого хоста посылать пакеты в любую сеть и независимо двигаться к пункту назначения (например, в другой сети). Они могут прибывать совершенно в другом порядке, чем были отправлены. Если требуется соблюдение порядка отправления, эту задачу выполняют более верхние уровни.
**Межсетевой уровень определяет официальный формат пакета** и протокол IP, с дополнительным протоколом ICMP (Internet Control Messege Protocol, межсетевой протокол управления сообщениями). **Задачей межсетевого протокола является доставка IP-пакетов к пунктам назначения.** Основными аспектами здесь являются выбор маршрута пакета и недопущение закупорки транспортных артерий (хотя IP не оказался эффективным для избегания скоплений).
**Межсетевой уровень регламентирует взаимодействие** между отдельными подсетями. Маршрутизация осуществляется путем обращения к определенному IP-адресу с использованием маски. Если хосты находятся в одной подсети, маркируемой одной маской, данные передаются напрямую. В противном случае информация «путешествует» по целой цепочке промежуточных звеньев, пока не достигнет нужной точки.

***Транспортный уровень***
*Уровень отвечает за контроль доставки*, чтобы не возникало дублей пакетов данных. В случае обнаружения потерь или ошибок информация запрашивается повторно. Такой подход дает возможность полностью автоматизировать процессы независимо от скорости и качества связи между отдельными участками интернета или внутри конкретной подсети.
*На этом уровне должны быть описаны два сквозных протокола.* 
Первый, **TCP** (Transmission Control Protocol — протокол управления передачей), является надежным протоколом с установлением соединений, позволяющим без ошибок доставлять байтовый поток с одной машины на любую другую машину объединенной сети. Он разбивает входной поток байтов на отдельные сообщения и передает их межсетевому уровню. На пункте назначения получающий TCP-процесс собирает из полученных сообщений выходной поток. Кроме того, TCP осуществляет управление потоком, чтобы быстрый отправитель не завалил информацией медленного получателя. 
Второй протокол этого уровня, **UDP** (User Dataram Protocol — протокол пользовательских дейтограмм2), является ненадежным протоколом без установления соединения, не использующим последовательное управление потоком протокола TCP, а предоставляющим свое собственное. Он также широко используется в одноразовых клиент-серверных запросах и приложениях, в которых оперативность важнее аккуратности, например при передаче речи и видео

***Прикладной уровень***
В модели TCP/IP нет сеансового уровня и уровня представления. В этих уровнях просто не было необходимости, поэтому они не были включены в модель. Вместо этого приложения просто включают все функции сеансов и представления, которые им нужны. *На этом уровне применяются стандарты интерфейса API, позволяющего передавать команды на выполнение определенных задач.*
**Возможно и использование «производных» протоколов.** Например, для открытия сайтов используется HTTPS, при отправке электронной почты – SMTP, для назначения IP-адресов – DHCP. Такой подход упрощает программирование, снижает нагрузку на сеть, увеличивает скорость обработки команд и передачи данных.

***Порты и сокеты***
Процессы, работающие на прикладном уровне, «общаются» с транспортным, но они видны ему как «черные ящики» с зашифрованной информацией. Зато он понимает, на какой IP-адрес адресованы данные и через какой порт надо их принимать. Этого достаточно для точного распределения пакетов по сети независимо от месторасположения хостов.
***Комбинация "IP-адрес и порт" называется сокетом***


[[Сети]] 
#TCP/IP #Сетевыеуровни #API
